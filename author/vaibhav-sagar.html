<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Vaibhav Sagar's Site - Vaibhav Sagar</title>
        <link rel="stylesheet" href="http://www.vaibhavsagar.com/theme/css/main.css" />
        <link href="http://www.vaibhavsagar.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Vaibhav Sagar's Site Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a href="https://github.com/vaibhavsagar">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="http://www.vaibhavsagar.com/">Vaibhav Sagar's Site </a></h1>
                <nav><ul>
                    <li><a href="/blog/archives/">all</a></li>
                    <li><a href="http://www.vaibhavsagar.com/about/">about</a></li>
                    <li><a href="http://www.vaibhavsagar.com/blog/misc/">misc</a></li>
                    <li><a href="http://www.vaibhavsagar.com/blog/programming/">programming</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://www.vaibhavsagar.com/blog/2017/05/29/imperative-haskell/">Imperative Haskell</a></h1>
<footer class="post-info">
        <abbr class="published" title="2017-05-29T00:00:00+10:00">
                Published: Mon 29 May 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info --><p><em>This post covers essentially the same material as a 5-minute presentation I
gave at RC, because giving that talk over and over again doesn't scale and
there are things I would like to cover that are difficult within that time
limit.</em></p>
<p>I was working through Tim Roughgarden's <a href="https://www.coursera.org/learn/algorithm-design-analysis/">Algorithms
1</a> (which has now
been replaced by two smaller courses) and attempting to do all the exercises in
Haskell when I bumped up against an uncomfortable truth. Haskell's 'quicksort':</p>
<div class="highlight"><pre><span></span><span class="nf">qsort</span> <span class="kt">[]</span>     <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">qsort</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">lt</span> <span class="o">++</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">++</span> <span class="n">gt</span>
    <span class="kr">where</span> <span class="n">lt</span> <span class="ow">=</span> <span class="n">qsort</span> <span class="p">[</span><span class="n">e</span> <span class="o">|</span> <span class="n">e</span> <span class="ow">&lt;-</span> <span class="n">xs</span><span class="p">,</span> <span class="n">e</span> <span class="o">&lt;</span>  <span class="n">x</span><span class="p">]</span>
          <span class="n">gt</span> <span class="ow">=</span> <span class="n">qsort</span> <span class="p">[</span><span class="n">e</span> <span class="o">|</span> <span class="n">e</span> <span class="ow">&lt;-</span> <span class="n">xs</span><span class="p">,</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">]</span>
</pre></div>


<p>isn't a true quicksort! Specifically, it doesn't sort the elements in place,
and the assignment I was working on involved counting the number of
comparisons, so I couldn't get away with my fake quicksort. With my tail
between my legs, I gave up on my pure Haskell approach and implemented a
solution in Python:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">partition_first</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">array</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">partition_last</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="n">array</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">partition_first</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">partition_median</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="n">p_idx</span> <span class="o">=</span> <span class="n">choose_median</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">array</span><span class="p">[</span><span class="n">p_idx</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">p_idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">partition_first</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">choose_median</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="n">head</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">r</span><span class="o">-</span><span class="n">l</span>
    <span class="k">if</span> <span class="n">length</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">mid_idx</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="p">(</span><span class="n">length</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mid_idx</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="p">(</span><span class="n">length</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">mid</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">mid_idx</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[(</span><span class="n">l</span><span class="p">,</span> <span class="n">head</span><span class="p">),</span> <span class="p">(</span><span class="n">mid_idx</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">last</span><span class="p">)]</span>
    <span class="n">options</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">options</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">quicksort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">partition</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">comparisons</span>
    <span class="k">if</span> <span class="n">end</span><span class="o">&lt;=</span><span class="n">start</span><span class="p">:</span> <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p_idx</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
        <span class="n">comparisons</span> <span class="o">+=</span> <span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">quicksort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">p_idx</span><span class="p">,</span> <span class="n">partition</span><span class="p">)</span>
        <span class="n">quicksort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">p_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">partition</span><span class="p">)</span>


<span class="n">comparisons</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">inp1</span> <span class="o">=</span> <span class="n">contents</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">quicksort</span><span class="p">(</span><span class="n">inp1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp1</span><span class="p">),</span> <span class="n">partition_first</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">comparisons</span><span class="p">)</span>

<span class="n">comparisons</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">inp2</span> <span class="o">=</span> <span class="n">contents</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">quicksort</span><span class="p">(</span><span class="n">inp2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp2</span><span class="p">),</span> <span class="n">partition_last</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">comparisons</span><span class="p">)</span>

<span class="n">comparisons</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">inp3</span> <span class="o">=</span> <span class="n">contents</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">quicksort</span><span class="p">(</span><span class="n">inp3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp3</span><span class="p">),</span> <span class="n">partition_median</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">comparisons</span><span class="p">)</span>
</pre></div>


<p>This implementation is not particularly Pythonic: note the recursion limit and
the use of a global variable. I actually forgot to reset the variable to 0
between iterations, which was fun to track down. But it works!</p>
<p>So far, so good. This isn't something we'd be able to do in Haskell, right? And
even if we could, the equivalent implementation would be so different as to be
unrecognisable. At least this is what I thought until I took a closer look at
<a href="https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-ST.html">Control.Monad.ST</a> and <a href="https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-STRef.html">Data.STRef</a>.</p>
<p>One of my biggest gripes with Haskell is the quality of the documentation.
<code>Control.Monad.ST</code> is introduced as</p>
<blockquote>
<p>This library provides support for strict state threads, as described in the
PLDI '94 paper by John Launchbury and Simon Peyton Jones <em>Lazy Functional
State Threads</em>.</p>
</blockquote>
<p>and <code>Data.STRef</code> is introduced as</p>
<blockquote>
<p>Mutable references in the (strict) ST monad.</p>
</blockquote>
<p>I don't want to read a paper to figure out how to use these libraries, and in
fact I don't have to! In recognition of this, I humbly present alternative
descriptions for <code>Control.Monad.ST</code>:</p>
<blockquote>
<p>You asked for mutable state, here it is!</p>
</blockquote>
<p>and <code>Data.STRef</code>:</p>
<blockquote>
<p>Variables that you can actually vary!!!1!1!one!1eleventyone</p>
</blockquote>
<p>Code utilising these libraries can look very familiar to people used to
imperative languages, e.g. past me. Here's the above quicksort rewritten in
Haskell:</p>
<div class="highlight"><pre><span></span><span class="cm">{-# LANGUAGE RankNTypes #-}</span>

<span class="kr">import</span> <span class="nn">Control.Monad.ST</span>
<span class="kr">import</span> <span class="nn">Data.STRef</span>
<span class="kr">import</span> <span class="nn">Data.Vector</span> <span class="p">(</span><span class="nf">fromList</span><span class="p">,</span> <span class="nf">toList</span><span class="p">,</span> <span class="nf">freeze</span><span class="p">,</span> <span class="nf">thaw</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Control.Monad</span>
<span class="kr">import</span> <span class="nn">Data.Vector.Mutable</span> <span class="p">(</span><span class="kt">STVector</span><span class="p">,</span> <span class="nf">read</span><span class="p">,</span> <span class="nf">write</span><span class="p">,</span> <span class="nf">swap</span><span class="p">)</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Vector</span> <span class="k">as</span> <span class="n">V</span> <span class="p">(</span><span class="kt">Vector</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.List</span> <span class="p">(</span><span class="nf">sortOn</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Prelude</span> <span class="k">hiding</span> <span class="p">(</span><span class="nf">read</span><span class="p">)</span>

<span class="nf">vector</span> <span class="ow">=</span> <span class="n">fromList</span> <span class="n">contents</span>

<span class="nf">partitionFirst</span> <span class="n">array</span> <span class="n">l</span> <span class="n">r</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">p</span> <span class="ow">&lt;-</span> <span class="n">read</span> <span class="n">array</span> <span class="n">l</span>
    <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">newSTRef</span> <span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">forM_</span> <span class="p">[</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">..</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">$</span> <span class="nf">\</span><span class="n">j</span> <span class="ow">-&gt;</span> <span class="kr">do</span>
        <span class="n">arrayJ</span> <span class="ow">&lt;-</span> <span class="n">read</span> <span class="n">array</span> <span class="n">j</span>
        <span class="n">i&#39;</span>     <span class="ow">&lt;-</span> <span class="n">readSTRef</span> <span class="n">i</span>
        <span class="n">when</span> <span class="p">(</span><span class="n">arrayJ</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">)</span> <span class="o">$</span> <span class="kr">do</span>
            <span class="n">swap</span> <span class="n">array</span> <span class="n">i&#39;</span> <span class="n">j</span>
            <span class="n">modifySTRef&#39;</span> <span class="n">i</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">i&#39;</span> <span class="ow">&lt;-</span> <span class="n">readSTRef</span> <span class="n">i</span>
    <span class="n">swap</span> <span class="n">array</span> <span class="p">(</span><span class="n">i&#39;</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">l</span>
    <span class="n">return</span> <span class="p">(</span><span class="n">i&#39;</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nf">partitionLast</span> <span class="n">array</span> <span class="n">l</span> <span class="n">r</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">swap</span> <span class="n">array</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">l</span>
    <span class="n">partitionFirst</span> <span class="n">array</span> <span class="n">l</span> <span class="n">r</span>

<span class="nf">partitionMedian</span> <span class="n">array</span> <span class="n">l</span> <span class="n">r</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">p</span> <span class="ow">&lt;-</span> <span class="n">chooseMedian</span> <span class="n">array</span> <span class="n">l</span> <span class="n">r</span>
    <span class="n">swap</span> <span class="n">array</span> <span class="n">p</span> <span class="n">l</span>
    <span class="n">partitionFirst</span> <span class="n">array</span> <span class="n">l</span> <span class="n">r</span>

<span class="nf">chooseMedian</span> <span class="n">array</span> <span class="n">l</span> <span class="n">r</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">h</span> <span class="ow">&lt;-</span> <span class="n">read</span> <span class="n">array</span> <span class="n">l</span>
    <span class="n">t</span> <span class="ow">&lt;-</span> <span class="n">read</span> <span class="n">array</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="kr">let</span> <span class="n">len</span> <span class="ow">=</span> <span class="n">r</span><span class="o">-</span><span class="n">l</span>
    <span class="kr">let</span> <span class="n">mid</span> <span class="ow">=</span> <span class="kr">if</span> <span class="p">(</span><span class="n">len</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="kr">then</span> <span class="n">l</span> <span class="o">+</span> <span class="p">(</span><span class="n">len</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="kr">else</span> <span class="n">l</span> <span class="o">+</span> <span class="p">(</span><span class="n">len</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">m</span> <span class="ow">&lt;-</span> <span class="n">read</span> <span class="n">array</span> <span class="n">mid</span>
    <span class="kr">let</span> <span class="n">options</span> <span class="ow">=</span> <span class="n">sortOn</span> <span class="n">snd</span> <span class="p">[(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)]</span>
    <span class="n">return</span> <span class="p">(</span><span class="n">fst</span> <span class="p">(</span><span class="n">options</span> <span class="o">!!</span> <span class="mi">1</span><span class="p">))</span>

<span class="nf">quicksort</span> <span class="n">array</span> <span class="n">start</span> <span class="n">end</span> <span class="n">partition</span> <span class="n">comparisons</span> <span class="ow">=</span> <span class="n">when</span> <span class="p">(</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">)</span> <span class="o">$</span> <span class="kr">do</span>
    <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">partition</span> <span class="n">array</span> <span class="n">start</span> <span class="n">end</span>
    <span class="n">modifySTRef&#39;</span> <span class="n">comparisons</span> <span class="p">(</span><span class="o">+</span> <span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">quicksort</span> <span class="n">array</span> <span class="n">start</span> <span class="n">i</span>   <span class="n">partition</span> <span class="n">comparisons</span>
    <span class="n">quicksort</span> <span class="n">array</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">end</span> <span class="n">partition</span> <span class="n">comparisons</span>

<span class="nf">quicksort&#39;</span> <span class="ow">::</span> <span class="kt">Ord</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="kt">V</span><span class="o">.</span><span class="kt">Vector</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">forall</span> <span class="n">s</span> <span class="n">a</span><span class="o">.</span> <span class="p">(</span><span class="kt">Ord</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">STVector</span> <span class="n">s</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">ST</span> <span class="n">s</span> <span class="kt">Int</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">quicksort&#39;</span> <span class="n">vector</span> <span class="n">partition</span> <span class="ow">=</span> <span class="n">runST</span> <span class="o">$</span> <span class="kr">do</span>
    <span class="n">array</span>  <span class="ow">&lt;-</span> <span class="n">thaw</span> <span class="n">vector</span>
    <span class="n">comps</span>  <span class="ow">&lt;-</span> <span class="n">newSTRef</span> <span class="mi">0</span>
    <span class="n">quicksort</span> <span class="n">array</span> <span class="mi">0</span> <span class="p">(</span><span class="kt">V</span><span class="o">.</span><span class="n">length</span> <span class="n">vector</span><span class="p">)</span> <span class="n">partition</span> <span class="n">comps</span>
    <span class="n">readSTRef</span> <span class="n">comps</span>

<span class="nf">quicksort&#39;</span> <span class="n">vector</span> <span class="n">partitionFirst</span>
<span class="nf">quicksort&#39;</span> <span class="n">vector</span> <span class="n">partitionLast</span>
<span class="nf">quicksort&#39;</span> <span class="n">vector</span> <span class="n">partitionMedian</span>
</pre></div>


<p>This is roughly the same length as the Python implementation, and even improves
on it in some ways: no recursion limit fiddling and no global variables.</p>
<p>If we can write Haskell that resembles Python, and Python is executable
pseudocode, can we cut out the middleman and translate pseudocode directly to
Haskell? Let's take a look at another problem.</p>
<p>I needed to calculate the size of the strongly connected components of a graph
for another assignment, and I decided to use Tarjan's Strongly Connected
Components algorithm. The pseudocode for that (as taken from Wikipedia) is:</p>
<div class="highlight"><pre><span></span> algorithm tarjan is
  input: graph G = (V, E)
  output: set of strongly connected components (sets of vertices)

  index := 0
  S := empty array
  for each v in V do
    if (v.index is undefined) then
      strongconnect(v)
    end if
  end for

  function strongconnect(v)
    // Set the depth index for v to the smallest unused index
    v.index := index
    v.lowlink := index
    index := index + 1
    S.push(v)
    v.onStack := true

    // Consider successors of v
    for each (v, w) in E do
      if (w.index is undefined) then
        // Successor w has not yet been visited; recurse on it
        strongconnect(w)
        v.lowlink  := min(v.lowlink, w.lowlink)
      else if (w.onStack) then
        // Successor w is in stack S and hence in the current SCC
        // Note: The next line may look odd - but is correct.
        // It says w.index not w.lowlink; that is deliberate and from the original paper
        v.lowlink  := min(v.lowlink, w.index)
      end if
    end for

    // If v is a root node, pop the stack and generate an SCC
    if (v.lowlink = v.index) then
      start a new strongly connected component
      repeat
        w := S.pop()
        w.onStack := false
        add w to current strongly connected component
      while (w != v)
      output the current strongly connected component
    end if
  end function
</pre></div>


<p>and here's what that looks like in Haskell:</p>
<div class="highlight"><pre><span></span><span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Graph</span> <span class="k">as</span> <span class="n">G</span>
<span class="kr">import</span> <span class="nn">Control.Monad.ST</span>
<span class="kr">import</span> <span class="nn">Data.STRef</span>

<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Map.Strict</span>    <span class="k">as</span> <span class="n">M</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Set</span>           <span class="k">as</span> <span class="n">S</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.IntMap.Strict</span> <span class="k">as</span> <span class="n">I</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Array</span>         <span class="k">as</span> <span class="n">A</span>

<span class="kr">import</span> <span class="nn">Control.Monad</span> <span class="p">(</span><span class="nf">forM_</span><span class="p">,</span> <span class="nf">when</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Maybe</span> <span class="p">(</span><span class="nf">isNothing</span><span class="p">,</span> <span class="nf">fromJust</span><span class="p">)</span>

<span class="nf">tarjan</span> <span class="n">graph</span> <span class="ow">=</span> <span class="n">runST</span> <span class="o">$</span> <span class="kr">do</span>
    <span class="n">index</span>    <span class="ow">&lt;-</span> <span class="n">newSTRef</span> <span class="mi">0</span>
    <span class="n">stack</span>    <span class="ow">&lt;-</span> <span class="n">newSTRef</span> <span class="kt">[]</span>
    <span class="n">indices</span>  <span class="ow">&lt;-</span> <span class="n">newSTRef</span> <span class="kt">I</span><span class="o">.</span><span class="n">empty</span>
    <span class="n">lowlinks</span> <span class="ow">&lt;-</span> <span class="n">newSTRef</span> <span class="kt">I</span><span class="o">.</span><span class="n">empty</span>
    <span class="n">output</span>   <span class="ow">&lt;-</span> <span class="n">newSTRef</span> <span class="kt">[]</span>

    <span class="n">forM_</span> <span class="p">(</span><span class="kt">G</span><span class="o">.</span><span class="n">vertices</span> <span class="n">graph</span><span class="p">)</span> <span class="o">$</span> <span class="nf">\</span><span class="n">v</span> <span class="ow">-&gt;</span> <span class="kr">do</span>
        <span class="n">vIndex</span> <span class="ow">&lt;-</span> <span class="kt">I</span><span class="o">.</span><span class="n">lookup</span> <span class="n">v</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">indices</span>
        <span class="n">when</span> <span class="p">(</span><span class="n">isNothing</span> <span class="n">vIndex</span><span class="p">)</span> <span class="o">$</span> <span class="n">strongConnect</span> <span class="n">v</span> <span class="n">graph</span> <span class="n">index</span> <span class="n">stack</span> <span class="n">indices</span> <span class="n">lowlinks</span> <span class="n">output</span>

    <span class="n">reverse</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">output</span>

<span class="nf">strongConnect</span> <span class="n">v</span> <span class="n">graph</span> <span class="n">index</span> <span class="n">stack</span> <span class="n">indices</span> <span class="n">lowlinks</span> <span class="n">output</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">readSTRef</span> <span class="n">index</span>
    <span class="n">modifySTRef&#39;</span> <span class="n">indices</span>  <span class="p">(</span><span class="kt">I</span><span class="o">.</span><span class="n">insert</span> <span class="n">v</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">modifySTRef&#39;</span> <span class="n">lowlinks</span> <span class="p">(</span><span class="kt">I</span><span class="o">.</span><span class="n">insert</span> <span class="n">v</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">modifySTRef&#39;</span> <span class="n">index</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">push</span> <span class="n">stack</span> <span class="n">v</span>

    <span class="n">forM_</span> <span class="p">(</span><span class="n">graph</span> <span class="kt">A</span><span class="o">.!</span> <span class="n">v</span><span class="p">)</span> <span class="o">$</span> <span class="nf">\</span><span class="n">w</span> <span class="ow">-&gt;</span> <span class="kr">do</span>
        <span class="n">wIndex</span> <span class="ow">&lt;-</span> <span class="kt">I</span><span class="o">.</span><span class="n">lookup</span> <span class="n">w</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">indices</span>
        <span class="kr">if</span> <span class="n">isNothing</span> <span class="n">wIndex</span>
            <span class="kr">then</span> <span class="kr">do</span>
                <span class="n">strongConnect</span> <span class="n">w</span> <span class="n">graph</span> <span class="n">index</span> <span class="n">stack</span> <span class="n">indices</span> <span class="n">lowlinks</span> <span class="n">output</span>
                <span class="n">vLowLink</span> <span class="ow">&lt;-</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="kt">I</span><span class="o">.</span><span class="n">lookup</span> <span class="n">v</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">lowlinks</span>
                <span class="n">wLowLink</span> <span class="ow">&lt;-</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="kt">I</span><span class="o">.</span><span class="n">lookup</span> <span class="n">w</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">lowlinks</span>
                <span class="n">modifySTRef&#39;</span> <span class="n">lowlinks</span> <span class="p">(</span><span class="kt">I</span><span class="o">.</span><span class="n">insert</span> <span class="n">v</span> <span class="o">$</span> <span class="n">min</span> <span class="n">vLowLink</span> <span class="n">wLowLink</span><span class="p">)</span>
            <span class="kr">else</span> <span class="kr">do</span>
                <span class="n">wOnStack</span> <span class="ow">&lt;-</span> <span class="n">elem</span> <span class="n">w</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">stack</span>
                <span class="n">when</span> <span class="n">wOnStack</span> <span class="o">$</span> <span class="kr">do</span>
                    <span class="n">vLowLink</span> <span class="ow">&lt;-</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="kt">I</span><span class="o">.</span><span class="n">lookup</span> <span class="n">v</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">lowlinks</span>
                    <span class="n">modifySTRef&#39;</span> <span class="n">lowlinks</span> <span class="p">(</span><span class="kt">I</span><span class="o">.</span><span class="n">insert</span> <span class="n">v</span> <span class="o">$</span> <span class="n">min</span> <span class="n">vLowLink</span> <span class="p">(</span><span class="n">fromJust</span> <span class="n">wIndex</span><span class="p">))</span>

    <span class="n">vLowLink</span> <span class="ow">&lt;-</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="kt">I</span><span class="o">.</span><span class="n">lookup</span> <span class="n">v</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">lowlinks</span>
    <span class="n">vIndex</span>   <span class="ow">&lt;-</span> <span class="n">fromJust</span> <span class="o">.</span> <span class="kt">I</span><span class="o">.</span><span class="n">lookup</span> <span class="n">v</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">indices</span>
    <span class="n">when</span> <span class="p">(</span><span class="n">vLowLink</span> <span class="o">==</span> <span class="n">vIndex</span><span class="p">)</span> <span class="o">$</span> <span class="kr">do</span>
        <span class="n">scc</span> <span class="ow">&lt;-</span> <span class="n">addSCC</span> <span class="n">v</span> <span class="kt">[]</span> <span class="n">stack</span>
        <span class="n">modifySTRef&#39;</span> <span class="n">output</span> <span class="p">(</span><span class="n">scc</span><span class="kt">:</span><span class="p">)</span>

<span class="nf">addSCC</span> <span class="n">v</span> <span class="n">scc</span> <span class="n">stack</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">w</span> <span class="ow">&lt;-</span> <span class="n">pop</span> <span class="n">stack</span>
    <span class="kr">let</span> <span class="n">scc&#39;</span> <span class="ow">=</span> <span class="n">w</span><span class="kt">:</span><span class="n">scc</span>
    <span class="kr">if</span> <span class="n">w</span> <span class="o">==</span> <span class="n">v</span> <span class="kr">then</span> <span class="n">return</span> <span class="n">scc&#39;</span> <span class="kr">else</span> <span class="n">addSCC</span> <span class="n">v</span> <span class="n">scc&#39;</span> <span class="n">stack</span>

<span class="nf">push</span> <span class="n">stack</span> <span class="n">e</span> <span class="ow">=</span> <span class="n">modifySTRef&#39;</span> <span class="n">stack</span> <span class="p">(</span><span class="n">e</span><span class="kt">:</span><span class="p">)</span>
<span class="nf">pop</span>  <span class="n">stack</span>   <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">e</span> <span class="ow">&lt;-</span> <span class="n">head</span> <span class="o">&lt;$&gt;</span> <span class="n">readSTRef</span> <span class="n">stack</span>
    <span class="n">modifySTRef&#39;</span> <span class="n">stack</span> <span class="n">tail</span>
    <span class="n">return</span> <span class="n">e</span>
</pre></div>


<p>Aside from explicitly declaring our variables and passing them around, I think
this looks pretty close.</p>
<p>How do we square this with Haskell's reputation for purity and referential
transparency? That's the subject of <a href="http://research.microsoft.com/en-us/um/people/simonpj/Papers/state-lasc.pdf">the paper mentioned
above</a>
that you don't have to read (but totally can if you want)! They figured out a
way to provide a principled pure interface to mutable state by passing the
references as arguments into each function that makes use of them and
leveraging the type system to make sure any impurity is well contained. The
correctness of this approach was <a href="http://iris-project.org/pdfs/2017-icfp-runST-submission.pdf">very recently
verified</a>. If
desired, we can replace any of the functions with purer and more idiomatic
definitions without changing the output, and that satisfies the definition of
referential transparency!</p>
<p>Why don't we do this all the time, when Haskell is at least a serviceable
imperative language? Because writing imperative programs is hard! They don't
compose as well, have less useful type signatures, and are harder to reason
about. Getting away from those things is why we have Haskell to begin with! The
real question should be: how can we avoid doing things this way as much as
possible?</p>
<p>Before I discovered this part of Haskell, I had this perception of Haskell (and
declarative programming more generally) as "imperative programming but less"
from a practical perspective. I thought that although writing declarative code
in Python was purely (heh) a matter of discipline, writing imperative code in
Haskell required completely reconceptualising the algorithm. Thanks to <code>ST</code>, I
now know that this not the case, which is a huge relief. If required, I can do
a literal translation of the algorithm, and clean it up (or not) later. In fact
Haskell is "imperative programming and more", and that's awesome!</p>
<p>Thanks to <a href="http://blog.podsnap.com/">Peter Fraenkel</a>, <a href="https://jvns.ca/">Julia
Evans</a>, and <a href="http://msteigerwalt.com/">Michelle Steigerwalt</a>
for feedback.</p>
<p><em>If you'd rather try to make sense of the <a href="https://github.com/vaibhavsagar/thursday-presentations/tree/master/imperative-haskell">set of disconnected
files</a>
that constitutes my slides for that presentation, you can do that instead,
although I wouldn't recommend it.</em></p><p>There are <a href="http://www.vaibhavsagar.com/blog/2017/05/29/imperative-haskell/#disqus_thread">comments</a>.</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2017/05/22/discovering-continuations/" rel="bookmark"
                           title="Permalink to Discovering Continuations with Typed Holes">Discovering Continuations with Typed Holes</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-05-22T00:00:00+10:00">
                Published: Mon 22 May 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <p>I've been trying to wrap my head around continuations for a while. I was reading <a href="https://github.com/quchen/articles/blob/master/cont_monad.md">David Luposchainsky's excellent article</a> on them and playing with his definitions in an IHaskell notebook when I found that typed holes are an excellent hammer to attack this particular nail with.</p>
<p>If you haven't encountered …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2017/05/22/discovering-continuations/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2017/05/22/discovering-continuations/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2017/02/26/getting-to-rc/" rel="bookmark"
                           title="Permalink to Getting to RC">Getting to RC</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-02-26T00:00:00+11:00">
                Published: Sun 26 February 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/misc/">misc</a>.</p>

</footer><!-- /.post-info -->                <p>You wouldn't know it from looking at my blog, but I attended a batch at the
Recurse Center from August to early November last year, and it was the best
experience of my life. Many Recursers write a return statement afterwards
reflecting on their time there, and in the process …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2017/02/26/getting-to-rc/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2017/02/26/getting-to-rc/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2017/01/24/simple-kv-store/" rel="bookmark"
                           title="Permalink to A Simple Key-Value Store with Servant">A Simple Key-Value Store with Servant</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-01-24T00:00:00+11:00">
                Published: Tue 24 January 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <p>The <a href="http://haskell-servant.readthedocs.io/en/stable/tutorial/Server.html#nested-apis">meat of the Servant
tutorial</a>
starts with an imposing list of language extensions and imports and only gets
more confusing from there. I don't think this gives newbies (i.e. me) the best
first impression of Servant. Let's build the simplest possible key-value store
with it instead.</p>
<p>We're going …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2017/01/24/simple-kv-store/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2017/01/24/simple-kv-store/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2016/10/12/monad-anti-tutorial/" rel="bookmark"
                           title="Permalink to Monad Anti-tutorial">Monad Anti-tutorial</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-10-12T00:00:00+11:00">
                Published: Wed 12 October 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <p>I think becoming familiar with the mechanics of working with monads is more
important than the question of what a monad is. For this reason, I think monad
tutorials solve the wrong problem. I'm giving you a monad anti-tutorial
instead, where I don't try to explain what a monad is …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2016/10/12/monad-anti-tutorial/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2016/10/12/monad-anti-tutorial/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2016/09/29/data-is-code/" rel="bookmark"
                           title="Permalink to Data Is Code">Data Is Code</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-09-29T00:00:00+10:00">
                Published: Thu 29 September 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <blockquote>
<p>Code is just smart data, and data is just dumb code.</p>
<ul>
<li>Structure and Interpretation of Computer Programs</li>
</ul>
</blockquote>
<p>I'm going to try to convince you that data is code. Strap yourselves in!</p>
<p>A <a href="https://en.wikipedia.org/wiki/Cons">cons cell</a> is a way of representing a
pair, and it has two operations, <a href="https://en.wikipedia.org/wiki/CAR_and_CDR"><code>car</code> and
<code>cdr</code></a>, to …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2016/09/29/data-is-code/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2016/09/29/data-is-code/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2016/07/24/writer-delta/" rel="bookmark"
                           title="Permalink to Using The Writer Monad Outside Logging">Using The Writer Monad Outside Logging</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-07-24T00:00:00+10:00">
                Published: Sun 24 July 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <p>I hadn't given much thought to the Writer monad before today, unlike the Reader and State monads, and part of the reason is that all the tutorials I encountered online focused on using it for logging. Although this is an obvious use case, I haven't had to do much logging …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2016/07/24/writer-delta/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2016/07/24/writer-delta/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2016/06/17/haskell-state/" rel="bookmark"
                           title="Permalink to You Could Have Invented The State Monad">You Could Have Invented The State Monad</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-06-17T00:00:00+10:00">
                Published: Fri 17 June 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <p>I'm attempting <a href="https://github.com/NICTA/course">NICTA/course</a> a second time. I
gave up the last time because none of the State exercises were making sense and
I found myself leaning so heavily on the solutions that I wasn't actually
learning anything. This time I was much better prepared after watching lots of
<a href="http://www.meetup.com/CanFPG/">CanFPG …</a></p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2016/06/17/haskell-state/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2016/06/17/haskell-state/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2015/05/10/git-it-going/" rel="bookmark"
                           title="Permalink to Git It Going - an Introduction to Git">Git It Going - an Introduction to Git</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-05-10T00:00:00+10:00">
                Published: Sun 10 May 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <p>I gave a talk on Git to the Canberra Python Users Group on the 7th of May. It
was my first ever technical talk, and I think it went fairly well.</p>
<p>When writing my presentation, I decided it would be most useful to demonstrate
<code>git</code> to the audience assuming some …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2015/05/10/git-it-going/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2015/05/10/git-it-going/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://www.vaibhavsagar.com/blog/2015/02/26/automate-resume/" rel="bookmark"
                           title="Permalink to Generate A PDF From Your Resume With Travis-CI">Generate A PDF From Your Resume With Travis-CI</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-02-26T00:00:00+11:00">
                Published: Thu 26 February 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.vaibhavsagar.com/author/vaibhav-sagar.html">Vaibhav Sagar</a>
        </address>
<p>In <a href="http://www.vaibhavsagar.com/blog/programming/">programming</a>.</p>

</footer><!-- /.post-info -->                <p>After <a href="http://www.vaibhavsagar.com/blog/2015/02/01/blog-setup/">automating my blog</a>, I decided to aim a little
higher and use Travis-CI to automate document generation from my resume. I use
<a href="http://johnmacfarlane.net/pandoc/">Pandoc</a> to convert my source resume written
in Markdown to Github-flavoured Markdown, an HTML file for my website, and a
PDF (via LaTeX) that I've spent a …</p>
                <a class="readmore" href="http://www.vaibhavsagar.com/blog/2015/02/26/automate-resume/">read more</a>
<p>There are <a href="http://www.vaibhavsagar.com/blog/2015/02/26/automate-resume/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 2
        <a href="http://www.vaibhavsagar.com/author/vaibhav-sagar2.html">&raquo;</a>
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://www.vaibhavsagar.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-79891461-1', 'auto');
    ga('send', 'pageview');
    </script>
<script type="text/javascript">
    var disqus_shortname = 'vaibhavsagar';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>